<!doctype html>
<html class="bg-gray-200">
  <head>
    <%- include("./_shared/head.ejs", {
      title: "How Doxxed Am I?",
      description: "Your onchain activity might be exposing more about you than you think."
    }) %>
  </head>
  <body class="min-h-screen p-4">
    <!-- Main Content -->
    <main class="max-w-2xl mx-auto mt-4">
      <!-- Landing Page Content -->
      <div id="landing-content" class="text-center">
        <!-- Logo -->
        <img src="./images/doxxie.png" alt="HDAI" class="h-28 mx-auto mb-4">

        <!-- Title -->
        <h1 class="text-4xl font-mono mb-6 text-center">HOW DOXXED AM I?</h1>

        <!-- Subtitle -->
        <p class="text-xl mb-8 max-w-lg mx-auto px-4">
          Your onchain activity might be exposing more about you than you think.
        </p>

        <!-- Feature Grid -->
        <div class="grid grid-cols-3 gap-8 mb-4">
          <!-- Location -->
          <div class="flex flex-col items-center">
            <img src="./images/icons/globe.svg" alt="Location" class="h-8">
            <span class="text-lg">Location</span>
          </div>

          <!-- Relationships -->
          <div class="flex flex-col items-center">
            <img src="./images/icons/connect.svg" alt="Relationships" class="h-8">
            <span class="text-lg">Relationships</span>
          </div>

          <!-- Assets -->
          <div class="flex flex-col items-center">
            <img src="./images/icons/dollar.svg" alt="Assets" class="h-8">
            <span class="text-lg">Assets</span>
          </div>
        </div>

        <!-- Second Row Grid -->
        <div class="grid grid-cols-2 mb-12">
          <!-- Names & Pseudonyms -->
          <div class="flex flex-col items-center">
            <img src="./images/ens.svg" alt="Names" class="h-8">
            <span class="text-base">Names &<br/>Pseudonyms</span>
          </div>

          <!-- Connected Wallets -->
          <div class="flex flex-col items-center">
            <img src="./images/icons/wallet.svg" alt="Wallet" class="h-8">
            <span class="text-base">Connected<br/>Wallets</span>
          </div>
        </div>

        <!-- Search Section -->
        <section class="mb-12" id="search-section">
          <h2 class="text-3xl font-bold mb-4 text-center">Audit Your Wallet Privacy</h2>
          <form id="search-form" class="relative max-w-xl mx-auto">
            <input
              type="search"
              name="wallet-address"
              id="wallet-address"
              placeholder="Wallet Address or ENS"
              class="w-full px-6 py-4 text-xl border-2 border-black rounded-lg shadow-lg pl-6 pr-16"
              required
              autocomplete="off"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false"
            >
            <button type="submit" class="absolute right-4 top-1/2 transform -translate-y-1/2 hover:opacity-70 transition-opacity">
              <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </button>
          </form>
        </section>

        <!-- Powered By Section -->
        <footer>
          <p class="text-sm mb-2 font-mono text-center">POWERED BY</p>
          <div class="flex justify-center items-center gap-10">
            <img src="./images/1inch.png" alt="ENS" class="h-12">
            <img src="./images/world.png" alt="Worldcoin" class="h-10">
            <img src="./images/ens.svg" alt="ENS" class="h-12">
            <img src="./images/farcaster.svg" alt="Farcaster" class="h-10">
          </div>
        </footer>
      </div>

      <!-- Loading Screen (Hidden by default) -->
      <div id="loading-screen" class="hidden fixed inset-0 bg-gray-200 bg-opacity-90 flex items-center justify-center z-50">
        <div class="text-center">
          <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-black mx-auto mb-4"></div>
          <p class="font-mono text-lg">Analyzing wallet...</p>
        </div>
      </div>

      <!-- Results Section (Hidden by default) -->
      <section id="results-section" class="hidden">
        <!-- Back Button -->
        <div class="max-w-xl mx-auto mb-8">
          <button id="back-button" class="flex items-center gap-2 text-sm font-mono hover:opacity-70 transition-opacity">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"/>
            </svg>
            BACK
          </button>
        </div>

        <!-- Wallet Address -->
        <div class="max-w-xl mx-auto mb-12">
          <div class="flex items-center gap-2">
            <img src="./images/icons/wallet.svg" alt="Wallets" class="h-4">
            <h2 class="font-mono text-sm tracking-wider">Wallet</h2>
          </div>
          <p class="font-mono text-sm text-gray-500 mt-1 break-all" id="wallet-address-resolved"></p>
        </div>

        <!-- Main Content -->
        <div class="max-w-xl mx-auto space-y-12">
          <!-- Portfolio Section -->
          <section>
            <div class="flex items-center gap-2 mb-2">
              <img src="./images/icons/dollar.svg" alt="Portfolio" class="h-4">
              <h2 class="font-mono text-sm tracking-wider">PORTFOLIO</h2>
            </div>
            <div class="flex items-baseline gap-3 mb-4">
              <span class="text-4xl font-mono font-bold tracking-wider" id="portfolio-value">$7,164.51</span>
              <span class="text-red-500 font-mono">-5.53%</span>
            </div>
            <div class="h-24 w-full">
              <canvas id="portfolio-chart"></canvas>
            </div>
          </section>

          <!-- ENS Names -->
          <section>
            <div class="flex items-center gap-2 mb-4">
              <img src="./images/ens.svg" alt="ENS" class="h-4">
              <h2 class="font-mono text-sm tracking-wider">ENS</h2>
            </div>
            <div class="space-y-2 font-mono text-sm" id="ens-names">
              <!-- ENS names will be populated here -->
            </div>
          </section>

          <!-- Wallet Relationships -->
          <section>
            <div class="flex items-center gap-2 mb-4">
              <img src="./images/icons/connect.svg" alt="Relationships" class="h-4">
              <h2 class="font-mono text-sm tracking-wider">WALLET RELATIONSHIPS</h2>
            </div>
            <div class="font-mono text-xs">
              <div class="space-y-[0.35rem]" id="wallet-relationships">
                <!-- Relationships will be populated here -->
              </div>
            </div>

            <div class="mt-8 relative h-72" id="bubble-chart">
              <!-- Dynamic bubbles will be populated here -->
            </div>
          </section>

          <!-- Location Data -->
          <section>
            <div class="flex items-center gap-2 mb-4">
              <img src="./images/icons/globe.svg" alt="Location" class="h-4">
              <h2 class="font-mono text-sm tracking-wider">LOCATION</h2>
            </div>
            <h3 class="font-mono text-xs text-gray-500 mb-3">TRANSACTIONS BY TIME OF DAY (UTC)</h3>
            <div class="space-y-2 mb-6" id="timezone-data">
              <!-- Timezone data will be populated here -->
            </div>
            <!-- <p class="font-mono text-xs" id="location-text">FARCASTER LOCATION: OKINAWA, JAPAN</p> -->
          </section>
        </div>
      </section>
    </main>

    <script defer type="module">
      import { copyAddress, analyzeAddress } from '/site/ui/index.js';
      window.copyAddress = copyAddress;
      window.analyzeAddress = analyzeAddress;
    </script>
    <script defer type="module" src="/site/index.js"></script>
  </body>
</html>
